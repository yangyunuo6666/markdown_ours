[toc]

***

# Excel_2021
+ **注意版本差异，旧版本可能不支持部分函数**
+ 公式运算用到辅助列：先复制结果后以数值形式粘贴后才可删除辅助列且不影响结果

## 基础知识
+ 绝对引用：固定列即向左拖动公式时列名不变，向下拖动公式时行号不变，用$表示
+ 下拉框制作：数据验证 -> 序列 -> 以,分割选项
+ 删除数据仅保留公式：选中，Ctrl + G + 公式中仅选中常量数字 + 清除单元格内容
+ 条件格式可用"=SUM(a+b)"，也可使用XLOOKUP函数，来核对数据
+ 公式对结果不对，考虑是否是格式不对比如数字用了文本格式
+ 插入图表：选中数据域，插入->图表
+ 插入迷你图：选中数据域，插入->迷你图
+ 排序：选中数据域，数据 -> 排序
+ 筛选：数据域，条件区，结果区
+ 分类汇总：数据->分类汇总
+ 数据透视表：插入-> 数据透视表(alt+N+V+Enter)，**数据分析、对比、汇总**
+ 模拟运算：数据->预测->模拟分析
  - **先写公式用于计算一个结果，后面用于模仿**
  - 单变量分析：找出能算出目标值的变量值；模拟分析->单变量求解(目标单元格为公式单元格，变量单元格为需要求解的单元格，求解值为目标值)
  - 模拟运算表：左上角为"=公式单元格"，选中模拟表，模拟分析->模拟运算表，输入引用的行单元格:选择行改变的变量原本的单元格，列同理。
    - 当仅需分析单一变量的影响时，可在首行插入一行左输默认值右输入"=公式单元格"，然后选中模拟表同理
## Excel快捷键
+ Ctrl + Tab ：切换工作薄
+ Ctrl + N ：新建工作薄
+ Shift + ‘右上角X' ：一键关闭打开的表

+ **Ctrl + 1：设置单元格格式，双击单元格右下角填充**
+ F4：锁定单元格
+ Ctrl + D ：向下填充
+ Ctrl + 输入 + enter ：批量输入
+ Ctrl + R ：向右填充
+ Ctrl + ALt + V : 粘贴以数值形式
+ shift + 空格 ：选行
+ Ctrl + 空格 ：选列
+ A1:C1 ：选中A1到C1
+ Ctrl + - ：删除行
+ 选中 + shift + 鼠标边缘拖动 ：移动选中区域

+ Ctrl + B ：加粗
+ Ctrl + I ：斜体
+ Ctrl + shift + ~ ：设置为常规格式
+ Ctrl + shift + - ：删除边框
  
+ Ctrl + Shift + ; ：输入当前时间
+ Ctrl + ; ：输入当前日期
+ Alt + = ：自动求和
+ Ctrl + ~ ：显示公式及其结果 
+ shift + F3 ：调出函数参数输入框



## Excel函数
+ iferror(公式,0):如果公式出错，则返回0
+ if(a>0,"是","否")
+ sumif(A1:C2,">0"):条件求和
+ sumproduct(A1:A2,B1:B2):两个数组对应元素相乘后求和
+ countif(A1:A2,">0"):条件计行数,count(A1:A2)计行数
+ index(A1:C1,1,2):返回A1:C1中(1,2)的值
+ 公式运算用到辅助列：先复制结果后以数值形式粘贴后才可删除辅助列且不影响结果
### left join
+ VLOOKUP(主键,数据域(外键必须为首行),需要数据域返回列索引,匹配方式)
  - 数据域首行不是外键时：数据域用 hstack(外键列，其他列,0):hstack拼接，注意列需要绝对索引，0为不重复。
  - 索引：{2,3,4}/column(B:D):返回数据域第2到4列横向填充，{2;3;4}/row(B2:D2):返回数据域第2到4列纵向填充
  - 匹配方式：0完全匹配，1模糊匹配
  - 多表查询：数据域用 Vstack((table1,table2),2,0):Vstack横向拼接，2为拼接列索引，0为不重复
  - 字段顺序不一致：索引用match(主表字段行,匹配表字段行,0)函数，返回匹配表字段索引
+ XLOOPUP(主键,查找域,返回数据列,匹配方式)
  - 查找域：查找域必须为单列，返回数据列必须为单列
  - 匹配方式：0完全匹配，1模糊匹配
  - 可选参数search_mode：1从第一个开始匹配，-1从最后一个开始匹配，2二进制升序搜索匹配，-2二进制降序搜索匹配，最后一个参数
  - XLOOKUP("李四", A1:A4, C1:C4, "未找到")，设置默认返回值，放于查找列之后。
  - 主键通配符：(1.*,·····)
  - 多条件查询：(主键1&主键2&主键3,·····)




















































































